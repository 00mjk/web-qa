# builder-tracker.sql is a database for $0
#
#
DROP DATABASE IF EXISTS qa_build_tracker;
CREATE DATABASE qa_build_tracker;

USE qa_build_tracker;

#
# Report Table
#
CREATE TABLE report (
	report_id	int unsigned not null auto_increment,
	report_date	datetime not null,
	report_user	int unsigned not null,
	report_data	int unsigned not null,
	PRIMARY KEY idx_report_id (report_id)
);

#
# Report Users Table
#
CREATE TABLE user (
	user_id		int unsigned not null auto_increment,
	user_name	varchar(64),
	user_email	varchar(128),
	PRIMARY KEY idx_user_id (user_id)
);

#
# Report Data Table
#
CREATE TABLE data (
	data_id		int unsigned not null auto_increment,
	data_version	int unsigned default NULL,
	data_cvs_date	datetime default NULL,
	data_snap_date	datetime default NULL,
	data_server_api	int unsigned not null,
	data_os			int unsigned not null,
	data_web_server	int unsigned not null,
	data_db			int unsigned not null,
	data_extensions	int unsigned default null,
	data_configure	blob,
	data_build_tools blob,
	data_bin_from	varchar(255) default NULL,
	data_php_ini	blob,
	data_other	blob,
	PRIMARY KEY idx_data_id (data_id)
);

#
# PHP Version Table
#
CREATE TABLE version (
	version_id	int unsigned not null auto_increment,
	version_major	tinyint unsigned not null,
	version_minor	tinyint unsigned not null,
	version_tag	char(8),
	PRIMARY KEY idx_version_id (version_id)
);


#
# Server API Table
#
CREATE TABLE server_api (
	server_api_id	int unsigned not null auto_increment,
	server_api_name	varchar(32),
	PRIMARY KEY idx_server_api (server_api_id)
);

#
# Extensions Table
#
CREATE TABLE extension (
	extension_id 	int unsigned not null auto_increment,
	extension_name	varchar(64),
	PRIMARY KEY idx_extension_id (extension_id)
);

#
# Relations : extensions / report
#
CREATE TABLE rel_extensions (
	rel_extensions_id	int unsigned not null auto_increment,
	report_id			int unsigned not null,
	extension_id		int unsigned not null,
	PRIMARY KEY idx_rel_extensions_id (rel_extensions_id)
);

#
# Server Software Table
#
CREATE TABLE web_server (
	web_server_id		int unsigned not null auto_increment,
	web_server_name		varchar(32),
	web_server_version	varchar(16),
	PRIMARY KEY idx_web_server_id (web_server_id)
);

#
# Database Software Table
#
CREATE TABLE db (
	db_id		int unsigned not null auto_increment,
	db_name		varchar(32),
	db_version	varchar(16),
	PRIMARY KEY idx_db_id (db_id)
);

#
# OS Table
#
CREATE TABLE os (
	os_id			int unsigned not null auto_increment,
	os_name			varchar(32),
	os_version		varchar(16),
	PRIMARY KEY idx_os_id (os_id)
);
